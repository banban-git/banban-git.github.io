<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.2/css/bulma.min.css" />
    <title>雑学４択</title>
  </head>
  <body>
    <div class="audio" style="display:none">
      <audio src="./audio/life.mp3" id="qmaAudio" controls="controls" />
    </div>

    <section  id="startArea" class="hero is-fullheight">
      <div class="hero-body">
        <div class="container has-text-centered">
          <a id="btnsend" class="button is-success is-outlined is-midium " style="margin-top:10px">雑学４択 ゲームスタート</a>
        </div>
      </div>
    </section>
    <section id="questionArea" style="display:none" class="hero is-fullheight">
      <div class="hero-body">
        <div class="container has-text-centered">
        <hgroup>  
            <b>雑学　４択</b>
        </hgroup>
        
        <section class="section-sub" style="border: 2px solid #000000">
          <div class="is-size-5" id="result">
        </section>
        <BR><BR>

        <section class="section-sub">
            <form name="form1">
              <span class="button is-danger sentaku1">
                A　<button class="btn button is-small is-outlined"" type="button" id="sentaku1" name="sentaku1" value="test"></button>
              </span><br>
              <span class="button is-link sentaku2">
                B　<button class="btn button is-small is-outlined"" type="button" id="sentaku2" name="sentaku2" value="test"></button>
              </span><br>
              <span class="button is-warning sentaku3">
                C　<button class="btn button is-small is-outlined"" type="button" id="sentaku3" name="sentaku3" value="test"></button>
              </span><br>
              <span class="button is-success sentaku4">
                D　<button class="btn button is-small is-outlined"" type="button" id="sentaku4" name="sentaku4" value="test"></button>
              </span><br>
              <input type="hidden" id="answer" name="answer" value="">
            </form>
        </section>
        </div>
      </div>
    </section>
   
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
   <script>
   $(function() {
      // 音声ファイルを読み込み
      var audio = $("#qmaAudio")[0];
      getTorivia();

      function getTorivia() {
      // Ajax通信を開始
      $.ajax({
        url: 'https://script.googleusercontent.com/macros/echo?user_content_key=pdXdEWheCBRAxr8W3iZyR54KibwUcNICTQJSEEeSTmNH6sq5DHF6m-gB7uLnw1Wh0FQmJ6GtoY7-hyiyQYsbGTpLsPMZSRJFm5_BxDlH2jW0nuo2oDemN9CCS2h10ox_1xSncGQajx_ryfhECjZEnI2VJD9wynt5wGJMH_voKxv8nCLsjlb84BaOudugYvptsGhvz8DTt7lnXqx2wdluzt8PGUzmKM7R09Y6yuavUIs53qZbZQxIgA&lib=Mc8zY5fM4utoF6lByjUpkrvIw6gzQYpwO',
        type: 'GET',
        async : false,  
        dataType: 'json'
      })
      .done(function(data) {
         document.getElementById('result').innerHTML = "<span class='eachTextAnime'>" + data.quiz + "</span><BR><BR><BR><BR><BR><BR><BR>"
         document.getElementById('sentaku1').value = data.sentaku1
         document.getElementById('sentaku1').innerHTML = "<span class=' has-text-weight-bold'>" + data.sentaku1 + "</span>"
         document.getElementById('sentaku2').value = data.sentaku2
         document.getElementById('sentaku2').innerHTML = "<span class=' has-text-weight-bold'>" + data.sentaku2 + "</span>"
         document.getElementById('sentaku3').value = data.sentaku3
         document.getElementById('sentaku3').innerHTML = "<span class=' has-text-weight-bold'>" + data.sentaku3 + "</span>"
         document.getElementById('sentaku4').value = data.sentaku4
         document.getElementById('sentaku4').innerHTML = "<span class=' has-text-weight-bold'>" + data.sentaku4 + "</span>"
         
         document.getElementById('answer').value = data.answer
         
      })
      .fail(function() {
          // 通信失敗時の処理を記述
          alert("通信エラー")
      });

      $('#btnsend').on('click', function(){
         // 音声の再生
         audio.load();
         audio.play();
         audio.loop = true;
         audio.volume = 0.8

         document.getElementById("startArea").style.display ="none"; 
         document.getElementById("questionArea").style.display =""; 
      });

      $('#sentaku1').on('click', function(){
         getAnswer(this);
      });
      $('#sentaku2').on('click', function(){
        getAnswer(this);
      });
      $('#sentaku3').on('click', function(){
        getAnswer(this);
      });
      $('#sentaku4').on('click', function(){
        getAnswer(this);
      });

      function getAnswer(sentakuId) {
        document.getElementById("sentaku1").disabled = true;
        document.getElementById("sentaku2").disabled = true;
        document.getElementById("sentaku3").disabled = true;
        document.getElementById("sentaku4").disabled = true;

        var sentaku = $(sentakuId).val(); 
        var answer = document.getElementById("answer").value;
        if (sentaku == answer) {
          document.getElementById('result').innerHTML = "<BR><BR><BR><span class='has-text-danger'>正解</span><BR><BR><BR><BR>"
        } else {
          document.getElementById('result').innerHTML = "<BR><BR><BR><span class='has-text-link'>不正解</span><BR><BR><BR><BR>"
        }
        
        setTimeout(countUp, 2000);
      }

      let count = 0;
      const countUp = () => {
         document.getElementById("sentaku1").disabled = false;
         document.getElementById("sentaku2").disabled = false;
         document.getElementById("sentaku3").disabled = false;
         document.getElementById("sentaku4").disabled = false;
         getTorivia();
       }  
    }
    });
   </script>
  <style>
  
  .btn { 
     width:500px;
  }
  .sentaku1,.sentaku2, .sentaku3 ,.sentaku4 { 
     margin-top: 15px;
  }
  @media screen and (min-width: 0) and (max-width: 768px){
    .btn { 
     width:300px;
    }    
  }
  </style>
  </body>
</html>